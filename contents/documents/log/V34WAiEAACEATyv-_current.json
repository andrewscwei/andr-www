{
  "id": "V34WAiEAACEATyv-",
  "uid": "using-the-arduino-ethernet-shield-with-tlc5940",
  "url": null,
  "type": "log",
  "href": "https://andr-mu.cdn.prismic.io/api/v2/documents/search?ref=ZwSajRAAACIA6x5O&q=%5B%5B%3Ad+%3D+at%28document.id%2C+%22V34WAiEAACEATyv-%22%29+%5D%5D",
  "tags": [
    "arduino",
    "c++"
  ],
  "first_publication_date": null,
  "last_publication_date": "2017-08-31T02:09:24+0000",
  "slugs": [
    "using-the-arduino-ethernet-shield-with-tlc5940"
  ],
  "linked_documents": [],
  "lang": "en-us",
  "alternate_languages": [],
  "data": {
    "title": [
      {
        "type": "heading1",
        "text": "Using the Arduino Ethernet Shield with TLC5940",
        "spans": []
      }
    ],
    "synopsis": [],
    "cover": {
      "dimensions": {
        "width": 1920,
        "height": 1080
      },
      "alt": null,
      "copyright": null,
      "url": "https://images.prismic.io/andr-mu/bde7128275eaf62add104151915603956336f1b3_arduino-ethernet-shield-cover.jpg?auto=compress,format",
      "id": "V34VuSEAACAATypL",
      "edit": {
        "x": 0,
        "y": -60,
        "zoom": 1,
        "background": "#fff"
      }
    },
    "markdown": [
      {
        "type": "preformatted",
        "text": "This log demonstrates how to use the TLC5940 chip with the Arduino Ethernet Shield, using the standard Arduino TLC5940 library.\n\n## Hardware Components\n\n1.  an Arduino Ethernet Shield\n2.  an Arduino I/O board that is compatible with the Ethernet Shield (Arduino Uno or Arduino Mega2560)\n3.  a TLC5940 chip\n\n## Software Components\n\n1.  [Arduino software](http://arduino.cc/en/Main/Software) - version 0022 at the time of writing this log\n2.  [Arduino TLC5940 library](http://www.arduino.cc/playground/Learning/TLC5940)\n\nThe Arduino TLC5940 library conflicts with the standard Ethernet Shield library because both libraries depend on pin D10 on the I/O board. A potential solution is to make the Ethernet Shield use D8 instead of D10 as well as setting the TLC5940 to BITBANG mode instead of SPI mode. This can be accomplished by physically altering the pin mapping of the Ethernet Shield and making minor modifications to both libraries.\n\n## Hardware Modifications\n\n1.  Bend or cut the leg of the D10 pin on the Ethernet Shield so it doesn't connect to the D10 pin of the I/O board\n2.  Connect D10 pin of Ethernet Shield to D8, using any method (wire it up, solder it, etc.)\n3.  Change the wiring from TLC5940 to Ethernet Shield:\n    BLANK -> PB2 (D10)\n    XLAT  -> PB1 (D9)\n    SIN   -> PD7 (D7)\n    XERR  -> PD6 (D6)\n    SCLK  -> PD4 (D4)\n    GSCLK -> PD3 (D3)\n\n## Software Modifications\n\n### Step 1: Edit `tlc_config.h`\n\nReplace this line:\n\n```c\n#define DATA_TRANSFER_MODE TLC_SPI\n```\n\nwith this line:\n\n```c\n#define DATA_TRANSFER_MODE TLC_BITBANG\n```\n\n### Step2: Open `w5100.h`\n\nlocation in Win: `\\arduino-0022\\libraries\\Ethernet\\utility\\`\nlocation in Mac: `\\Arduino.app\\Contents\\Resources\\Java\\libraries\\Ethernet\\utility\\`\n\nReplace this block of code:\n\n```c\nprivate:\n#if defined(__AVR_ATmega1280__) || defined(__AVR_ATmega2560__)\ninline static void initSS() { DDRB |= _BV(4); };\ninline static void setSS() { PORTB &= ~_BV(4); };\ninline static void resetSS() { PORTB |= _BV(4); };\n#else\ninline static void initSS() { DDRB |= _BV(2); };\ninline static void setSS() { PORTB &= ~_BV(2); };\ninline static void resetSS() { PORTB |= _BV(2); };\n#endif\n```\n\nwith this block of code:\n\n```c\nprivate:\n#if defined(__AVR_ATmega1280__) || defined(__AVR_ATmega2560__)\ninline static void initSS() { DDRB |= _BV(4); };\ninline static void setSS() { PORTB &= ~_BV(4); };\ninline static void resetSS() { PORTB |= _BV(4); };\n#else\ninline static void initSS() { DDRB |= _BV(0); };\ninline static void setSS() { PORTB &= ~_BV(0); };\ninline static void resetSS() { PORTB |= _BV(0); };\n#endif\n```\n\n### Step 3: Edit pins_arduino.h\n\nlocation in Win: `\\arduino-0022\\hardware\\arduino\\cores\\arduino\\`\nlocation in Mac: `\\Arduino.app\\Contents\\Resources\\Java\\hardware\\arduino\\cores\\arduino\\`\n\nReplace this block of code:\n\n```c\n#if defined(__AVR_ATmega1280__) || defined(__AVR_ATmega2560__)\nconst static uint8_t SS = 53;\nconst static uint8_t MOSI = 51;\nconst static uint8_t MISO = 50;\nconst static uint8_t SCK = 52;\n#else\nconst static uint8_t SS = 10;\nconst static uint8_t MOSI = 11;\nconst static uint8_t MISO = 12;\nconst static uint8_t SCK = 13;\n#endif\n```\n\nwith this block of code:\n\n```c\n#if defined(__AVR_ATmega1280__) || defined(__AVR_ATmega2560__)\nconst static uint8_t SS = 53;\nconst static uint8_t MOSI = 51;\nconst static uint8_t MISO = 50;\nconst static uint8_t SCK = 52;\n#else\nconst static uint8_t SS = 8;\nconst static uint8_t MOSI = 11;\nconst static uint8_t MISO = 12;\nconst static uint8_t SCK = 13;\n#endif\n```\n\n## Source(s)\n\n1.  [Arduino Forum Topic by toffe82](http://www.arduino.cc/cgi-bin/yabb2/YaBB.pl?num=1257363045)\n2.  [TLC5940 Datasheet](http://code.google.com/p/tlc5940arduino/)\n3.  [Arduino Software](http://arduino.cc/en/Main/Software)\n4.  [Arduino TLC5940 Library](http://www.arduino.cc/playground/Learning/TLC5940)\n",
        "spans": []
      }
    ],
    "date": "2011-06-22",
    "mathjax": null,
    "prism": "Yes"
  }
}
