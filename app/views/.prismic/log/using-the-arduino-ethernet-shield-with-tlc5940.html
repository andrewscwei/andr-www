---
title: 'Using the Arduino Ethernet Shield with TLC5940'
cover: 'https://andr-mu.cdn.prismic.io/andr-mu/bde7128275eaf62add104151915603956336f1b3_arduino-ethernet-shield-cover.jpg'
markdown: "<p>This log demonstrates how to use the TLC5940 chip with the Arduino Ethernet Shield, using the standard Arduino TLC5940 library.</p>\n<h2 id=\"hardware-components\">Hardware Components</h2>\n<ol>\n<li>an Arduino Ethernet Shield</li>\n<li>an Arduino I/O board that is compatible with the Ethernet Shield (Arduino Uno or Arduino Mega2560)</li>\n<li>a TLC5940 chip</li>\n</ol>\n<h2 id=\"software-components\">Software Components</h2>\n<ol>\n<li><a href=\"http://arduino.cc/en/Main/Software\">Arduino software</a> - version 0022 at the time of writing this log</li>\n<li><a href=\"http://www.arduino.cc/playground/Learning/TLC5940\">Arduino TLC5940 library</a></li>\n</ol>\n<p>The Arduino TLC5940 library conflicts with the standard Ethernet Shield library because both libraries depend on pin D10 on the I/O board. A potential solution is to make the Ethernet Shield use D8 instead of D10 as well as setting the TLC5940 to BITBANG mode instead of SPI mode. This can be accomplished by physically altering the pin mapping of the Ethernet Shield and making minor modifications to both libraries.</p>\n<h2 id=\"hardware-modifications\">Hardware Modifications</h2>\n<ol>\n<li>Bend or cut the leg of the D10 pin on the Ethernet Shield so it doesn&#39;t connect to the D10 pin of the I/O board</li>\n<li>Connect D10 pin of Ethernet Shield to D8, using any method (wire it up, solder it, etc.)</li>\n<li>Change the wiring from TLC5940 to Ethernet Shield:\nBLANK -&gt; PB2 (D10)\nXLAT  -&gt; PB1 (D9)\nSIN   -&gt; PD7 (D7)\nXERR  -&gt; PD6 (D6)\nSCLK  -&gt; PD4 (D4)\nGSCLK -&gt; PD3 (D3)</li>\n</ol>\n<h2 id=\"software-modifications\">Software Modifications</h2>\n<h3 id=\"step-1-edit-tlc_config-h-\">Step 1: Edit <code>tlc_config.h</code></h3>\n<p>Replace this line:</p>\n<pre><code class=\"language-c\">#define DATA_TRANSFER_MODE TLC_SPI\n</code></pre>\n<p>with this line:</p>\n<pre><code class=\"language-c\">#define DATA_TRANSFER_MODE TLC_BITBANG\n</code></pre>\n<h3 id=\"step2-open-w5100-h-\">Step2: Open <code>w5100.h</code></h3>\n<p>location in Win: <code>\\arduino-0022\\libraries\\Ethernet\\utility\\</code>\nlocation in Mac: <code>\\Arduino.app\\Contents\\Resources\\Java\\libraries\\Ethernet\\utility\\</code></p>\n<p>Replace this block of code:</p>\n<pre><code class=\"language-c\">private:\n#if defined(__AVR_ATmega1280__) || defined(__AVR_ATmega2560__)\ninline static void initSS() { DDRB |= _BV(4); };\ninline static void setSS() { PORTB &amp;= ~_BV(4); };\ninline static void resetSS() { PORTB |= _BV(4); };\n#else\ninline static void initSS() { DDRB |= _BV(2); };\ninline static void setSS() { PORTB &amp;= ~_BV(2); };\ninline static void resetSS() { PORTB |= _BV(2); };\n#endif\n</code></pre>\n<p>with this block of code:</p>\n<pre><code class=\"language-c\">private:\n#if defined(__AVR_ATmega1280__) || defined(__AVR_ATmega2560__)\ninline static void initSS() { DDRB |= _BV(4); };\ninline static void setSS() { PORTB &amp;= ~_BV(4); };\ninline static void resetSS() { PORTB |= _BV(4); };\n#else\ninline static void initSS() { DDRB |= _BV(0); };\ninline static void setSS() { PORTB &amp;= ~_BV(0); };\ninline static void resetSS() { PORTB |= _BV(0); };\n#endif\n</code></pre>\n<h3 id=\"step-3-edit-pins_arduino-h\">Step 3: Edit pins_arduino.h</h3>\n<p>location in Win: <code>\\arduino-0022\\hardware\\arduino\\cores\\arduino\\</code>\nlocation in Mac: <code>\\Arduino.app\\Contents\\Resources\\Java\\hardware\\arduino\\cores\\arduino\\</code></p>\n<p>Replace this block of code:</p>\n<pre><code class=\"language-c\">#if defined(__AVR_ATmega1280__) || defined(__AVR_ATmega2560__)\nconst static uint8_t SS = 53;\nconst static uint8_t MOSI = 51;\nconst static uint8_t MISO = 50;\nconst static uint8_t SCK = 52;\n#else\nconst static uint8_t SS = 10;\nconst static uint8_t MOSI = 11;\nconst static uint8_t MISO = 12;\nconst static uint8_t SCK = 13;\n#endif\n</code></pre>\n<p>with this block of code:</p>\n<pre><code class=\"language-c\">#if defined(__AVR_ATmega1280__) || defined(__AVR_ATmega2560__)\nconst static uint8_t SS = 53;\nconst static uint8_t MOSI = 51;\nconst static uint8_t MISO = 50;\nconst static uint8_t SCK = 52;\n#else\nconst static uint8_t SS = 8;\nconst static uint8_t MOSI = 11;\nconst static uint8_t MISO = 12;\nconst static uint8_t SCK = 13;\n#endif\n</code></pre>\n<h2 id=\"source-s-\">Source(s)</h2>\n<ol>\n<li><a href=\"http://www.arduino.cc/cgi-bin/yabb2/YaBB.pl?num=1257363045\">Arduino Forum Topic by toffe82</a></li>\n<li><a href=\"http://code.google.com/p/tlc5940arduino/\">TLC5940 Datasheet</a></li>\n<li><a href=\"http://arduino.cc/en/Main/Software\">Arduino Software</a></li>\n<li><a href=\"http://www.arduino.cc/playground/Learning/TLC5940\">Arduino TLC5940 Library</a></li>\n</ol>\n"
date: '2011-06-21'
id: V34WAiEAACEATyv-
uid: using-the-arduino-ethernet-shield-with-tlc5940
type: log
tags:
    - arduino
    - c++
---
